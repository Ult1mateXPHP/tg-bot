Валидация входящей ссылки (регулярка для полной и сокращённой ссылки)

Попытка получить доступные форматы для скачивания

Вывод доступных форматов в inline клавиатуре и приём выбранного формата=> отправка задания в очередь (redis). Перед отправкой задания проверяем существующие задания. Лимит на пользователя: 1 ссылка.

Задание в redis: ссылка, формат файла, id пользователя

Воркер который выполняет задания: качает по ссылке в нужном формате и потом отправляет видео/аудио в личку пользователю. Предварительно проверяем наличие уже скачанного файла(ссылки).

Файлы которые скачаны, удаляем по крону командой find (похожий механизм на сервере сессий). Удаляем всё, что старше N дней



По хорошему, нужны тесты на отдельные команды бота +Миграции для базы
+Наверное фикстуры для локалки


Поискать на гитхабе форум бота и посмотреть большие проекты их архитектуру. Либо, делать нечто модулей, как сейчас в ЛЗ. Например, YouTube модуль. Это и команда и всё что с ней может быть связано рядом (скачивание, работа с redis, с БД, callback команды)

Тогда более менее удобно делить структуру.

Глобально будет 2 больших модуля это клиент и бот.

Доменные сущности:
1. Это пользователи Клиента
2. Каналы для отложенного постинга
3. Чаты для модерации
4. Более мелкие сущности уже для обеспечения работы доменных (например, сущность Пост или РекламныйПост, УчастникЧата, ПодписчикКанала)

Свойства общие для всех:
* Список админов
* Роли?? (Или набор прав?)